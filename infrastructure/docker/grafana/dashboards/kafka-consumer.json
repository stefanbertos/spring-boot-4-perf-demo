{
  "annotations": {
    "list": []
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "panels": [],
      "title": "CPU",
      "type": "row"
    },
    {
      "title": "CPU Usage",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 1
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "process_cpu_usage{job=\"kafka-consumer\"}",
          "legendFormat": "{{instance}} Process"
        },
        {
          "expr": "system_cpu_usage{job=\"kafka-consumer\"}",
          "legendFormat": "{{instance}} System"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percentunit",
          "max": 1
        },
        "overrides": []
      }
    },
    {
      "title": "CPU Count",
      "type": "stat",
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 12,
        "y": 1
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "system_cpu_count{job=\"kafka-consumer\"}",
          "legendFormat": "CPU Cores"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      }
    },
    {
      "title": "Process Uptime",
      "type": "stat",
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 18,
        "y": 1
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "process_uptime_seconds{job=\"kafka-consumer\"}",
          "legendFormat": "Uptime"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      }
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 9
      },
      "panels": [],
      "title": "Memory",
      "type": "row"
    },
    {
      "title": "JVM Heap Memory",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 10
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "sum(jvm_memory_used_bytes{job=\"kafka-consumer\", area=\"heap\"}) by (pod)",
          "legendFormat": "{{instance}} Used"
        },
        {
          "expr": "sum(jvm_memory_committed_bytes{job=\"kafka-consumer\", area=\"heap\"}) by (pod)",
          "legendFormat": "{{instance}} Committed"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes"
        },
        "overrides": []
      }
    },
    {
      "title": "JVM Non-Heap Memory",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 10
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "sum(jvm_memory_used_bytes{job=\"kafka-consumer\", area=\"nonheap\"}) by (pod)",
          "legendFormat": "{{instance}} Used"
        },
        {
          "expr": "sum(jvm_memory_committed_bytes{job=\"kafka-consumer\", area=\"nonheap\"}) by (pod)",
          "legendFormat": "{{instance}} Committed"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes"
        },
        "overrides": []
      }
    },
    {
      "title": "JVM Buffer Memory",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 18
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "sum(jvm_buffer_memory_used_bytes{job=\"kafka-consumer\"}) by (pod, id)",
          "legendFormat": "{{instance}} {{id}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes"
        },
        "overrides": []
      }
    },
    {
      "title": "JVM Memory Pool Detail",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 18
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "jvm_memory_used_bytes{job=\"kafka-consumer\"}",
          "legendFormat": "{{id}} ({{area}})"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes"
        },
        "overrides": []
      }
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 26
      },
      "panels": [],
      "title": "Disk",
      "type": "row"
    },
    {
      "title": "Disk Space",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 27
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "disk_total_bytes{job=\"kafka-consumer\"}",
          "legendFormat": "Total"
        },
        {
          "expr": "disk_free_bytes{job=\"kafka-consumer\"}",
          "legendFormat": "Free"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes"
        },
        "overrides": []
      }
    },
    {
      "title": "Disk Usage %",
      "type": "gauge",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 27
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "1 - (disk_free_bytes{job=\"kafka-consumer\"} / disk_total_bytes{job=\"kafka-consumer\"})",
          "legendFormat": "Used %"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percentunit",
          "max": 1,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 0.7
              },
              {
                "color": "red",
                "value": 0.9
              }
            ]
          }
        },
        "overrides": []
      }
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 35
      },
      "panels": [],
      "title": "HTTP Server",
      "type": "row"
    },
    {
      "title": "HTTP Server Request Rate",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 36
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(http_server_requests_seconds_count{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "{{instance}} {{method}} {{uri}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "reqps"
        },
        "overrides": []
      }
    },
    {
      "title": "HTTP Server Response Time",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 36
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.25, sum(rate(http_server_requests_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p25"
        },
        {
          "expr": "histogram_quantile(0.50, sum(rate(http_server_requests_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p50"
        },
        {
          "expr": "histogram_quantile(0.75, sum(rate(http_server_requests_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p75"
        },
        {
          "expr": "histogram_quantile(0.90, sum(rate(http_server_requests_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p90"
        },
        {
          "expr": "histogram_quantile(0.95, sum(rate(http_server_requests_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p95"
        },
        {
          "expr": "histogram_quantile(0.99, sum(rate(http_server_requests_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p99"
        },
        {
          "expr": "histogram_quantile(0, sum(rate(http_server_requests_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "min"
        },
        {
          "expr": "http_server_requests_seconds_max{job=\"kafka-consumer\"}",
          "legendFormat": "max"
        },
        {
          "expr": "sum(rate(http_server_requests_seconds_sum{job=\"kafka-consumer\"}[$__rate_interval])) / sum(rate(http_server_requests_seconds_count{job=\"kafka-consumer\"}[$__rate_interval]))",
          "legendFormat": "avg"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      }
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 44
      },
      "panels": [],
      "title": "Tomcat",
      "type": "row"
    },
    {
      "title": "Tomcat Threads",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 45
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "tomcat_threads_current_threads{job=\"kafka-consumer\"}",
          "legendFormat": "{{instance}} Current"
        },
        {
          "expr": "tomcat_threads_busy_threads{job=\"kafka-consumer\"}",
          "legendFormat": "{{instance}} Busy"
        },
        {
          "expr": "tomcat_threads_config_max_threads{job=\"kafka-consumer\"}",
          "legendFormat": "{{instance}} Max"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      }
    },
    {
      "title": "Tomcat Connections",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 45
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "tomcat_connections_current_connections{job=\"kafka-consumer\"}",
          "legendFormat": "Current"
        },
        {
          "expr": "tomcat_connections_keepalive_current_connections{job=\"kafka-consumer\"}",
          "legendFormat": "Keep-Alive"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      }
    },
    {
      "title": "Tomcat Sessions",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 53
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "tomcat_sessions_active_current_sessions{job=\"kafka-consumer\"}",
          "legendFormat": "Active"
        },
        {
          "expr": "rate(tomcat_sessions_created_sessions_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "Created/s"
        },
        {
          "expr": "rate(tomcat_sessions_expired_sessions_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "Expired/s"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      }
    },
    {
      "title": "Tomcat Traffic",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 53
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(tomcat_global_sent_bytes_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "Sent"
        },
        {
          "expr": "rate(tomcat_global_received_bytes_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "Received"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "Bps"
        },
        "overrides": []
      }
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 61
      },
      "panels": [],
      "title": "JVM & Runtime",
      "type": "row"
    },
    {
      "title": "JVM Threads",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 62
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "jvm_threads_live_threads{job=\"kafka-consumer\"}",
          "legendFormat": "{{instance}} Live"
        },
        {
          "expr": "jvm_threads_daemon_threads{job=\"kafka-consumer\"}",
          "legendFormat": "{{instance}} Daemon"
        },
        {
          "expr": "jvm_threads_peak_threads{job=\"kafka-consumer\"}",
          "legendFormat": "{{instance}} Peak"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      }
    },
    {
      "title": "JVM Thread States",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 62
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "jvm_threads_states_threads{job=\"kafka-consumer\"}",
          "legendFormat": "{{state}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      }
    },
    {
      "title": "JVM Classes",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 70
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "jvm_classes_loaded_classes{job=\"kafka-consumer\"}",
          "legendFormat": "Loaded"
        },
        {
          "expr": "rate(jvm_classes_unloaded_classes_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "Unloaded/s"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      }
    },
    {
      "title": "JIT Compilation Time",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 70
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(jvm_compilation_time_ms_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "Compilation time/s"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ms"
        },
        "overrides": []
      }
    },
    {
      "title": "GC Overhead",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 78
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "jvm_gc_overhead{job=\"kafka-consumer\"}",
          "legendFormat": "{{instance}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percentunit",
          "max": 1
        },
        "overrides": []
      }
    },
    {
      "title": "GC Pause",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 78
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(jvm_gc_pause_seconds_count{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "{{action}} {{cause}} count/s"
        },
        {
          "expr": "rate(jvm_gc_pause_seconds_sum{job=\"kafka-consumer\"}[$__rate_interval]) / rate(jvm_gc_pause_seconds_count{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "{{action}} {{cause}} avg"
        },
        {
          "expr": "jvm_gc_pause_seconds_max{job=\"kafka-consumer\"}",
          "legendFormat": "{{action}} {{cause}} max"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      }
    },
    {
      "title": "GC Memory Promoted / Allocated",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 86
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(jvm_gc_memory_promoted_bytes_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "Promoted"
        },
        {
          "expr": "rate(jvm_gc_memory_allocated_bytes_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "Allocated"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "Bps"
        },
        "overrides": []
      }
    },
    {
      "title": "GC Live / Max Data Size",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 86
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "jvm_gc_live_data_size_bytes{job=\"kafka-consumer\"}",
          "legendFormat": "Live Data Size"
        },
        {
          "expr": "jvm_gc_max_data_size_bytes{job=\"kafka-consumer\"}",
          "legendFormat": "Max Data Size"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes"
        },
        "overrides": []
      }
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 94
      },
      "panels": [],
      "title": "Application Startup & Logging",
      "type": "row"
    },
    {
      "title": "Application Startup Time",
      "type": "stat",
      "gridPos": {
        "h": 4,
        "w": 8,
        "x": 0,
        "y": 95
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "application_started_time_seconds{job=\"kafka-consumer\"}",
          "legendFormat": "Started"
        },
        {
          "expr": "application_ready_time_seconds{job=\"kafka-consumer\"}",
          "legendFormat": "Ready"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      }
    },
    {
      "title": "JVM Info",
      "type": "stat",
      "gridPos": {
        "h": 4,
        "w": 8,
        "x": 8,
        "y": 95
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "jvm_info{job=\"kafka-consumer\"}",
          "legendFormat": "{{runtime}} {{version}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      }
    },
    {
      "title": "Open File Descriptors",
      "type": "timeseries",
      "gridPos": {
        "h": 4,
        "w": 8,
        "x": 16,
        "y": 95
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "process_files_open_files{job=\"kafka-consumer\"}",
          "legendFormat": "Open"
        },
        {
          "expr": "process_files_max_files{job=\"kafka-consumer\"}",
          "legendFormat": "Max"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      }
    },
    {
      "title": "Logback Events",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 99
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(logback_events_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "{{level}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ops"
        },
        "overrides": []
      }
    },
    {
      "title": "Process Start Time",
      "type": "stat",
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 12,
        "y": 99
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "process_start_time_seconds{job=\"kafka-consumer\"}",
          "legendFormat": "Start Time"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "dateTimeAsIso",
          "decimals": 0
        },
        "overrides": []
      }
    },
    {
      "title": "Uptime",
      "type": "stat",
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 18,
        "y": 99
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "process_uptime_seconds{job=\"kafka-consumer\"}",
          "legendFormat": "Uptime"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "dtdurations"
        },
        "overrides": []
      }
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 107
      },
      "panels": [],
      "title": "Kafka Client",
      "type": "row"
    },
    {
      "title": "Kafka Listener Record Processing Rate",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 108
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(spring_kafka_listener_seconds_count{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "{{name}} records/s"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ops"
        },
        "overrides": []
      }
    },
    {
      "title": "Kafka Listener Processing Latency",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 108
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.25, sum(rate(spring_kafka_listener_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p25"
        },
        {
          "expr": "histogram_quantile(0.50, sum(rate(spring_kafka_listener_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p50"
        },
        {
          "expr": "histogram_quantile(0.75, sum(rate(spring_kafka_listener_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p75"
        },
        {
          "expr": "histogram_quantile(0.90, sum(rate(spring_kafka_listener_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p90"
        },
        {
          "expr": "histogram_quantile(0.95, sum(rate(spring_kafka_listener_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p95"
        },
        {
          "expr": "histogram_quantile(0.99, sum(rate(spring_kafka_listener_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p99"
        },
        {
          "expr": "histogram_quantile(0, sum(rate(spring_kafka_listener_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "min"
        },
        {
          "expr": "spring_kafka_listener_seconds_max{job=\"kafka-consumer\"}",
          "legendFormat": "max"
        },
        {
          "expr": "sum(rate(spring_kafka_listener_seconds_sum{job=\"kafka-consumer\"}[$__rate_interval])) / sum(rate(spring_kafka_listener_seconds_count{job=\"kafka-consumer\"}[$__rate_interval]))",
          "legendFormat": "avg"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      }
    },
    {
      "title": "Kafka Consumer Records Consumed",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 116
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(kafka_consumer_fetch_manager_records_consumed_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "{{client_id}} records/s"
        },
        {
          "expr": "rate(kafka_consumer_fetch_manager_bytes_consumed_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "{{client_id}} bytes/s"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ops"
        },
        "overrides": []
      }
    },
    {
      "title": "Kafka Consumer Lag",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 116
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "kafka_consumer_fetch_manager_records_lag{job=\"kafka-consumer\"}",
          "legendFormat": "{{client_id}} {{topic}} [{{partition}}]"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      }
    },
    {
      "title": "Kafka Producer Records Sent",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 124
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(kafka_producer_topic_record_send_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "{{client_id}} {{topic}} records/s"
        },
        {
          "expr": "rate(kafka_producer_topic_record_error_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "{{client_id}} {{topic}} errors/s"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ops"
        },
        "overrides": []
      }
    },
    {
      "title": "Kafka Producer Latency",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 124
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "kafka_producer_record_queue_time_avg{job=\"kafka-consumer\"}",
          "legendFormat": "{{client_id}} queue time avg"
        },
        {
          "expr": "kafka_producer_request_latency_avg{job=\"kafka-consumer\"}",
          "legendFormat": "{{client_id}} request latency avg"
        },
        {
          "expr": "kafka_producer_batch_size_avg{job=\"kafka-consumer\"}",
          "legendFormat": "{{client_id}} batch size avg"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short"
        },
        "overrides": []
      }
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 132
      },
      "panels": [],
      "title": "Kafka Request Metrics",
      "type": "row"
    },
    {
      "title": "Kafka Request TPS (Total)",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 0,
        "y": 133
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "sum(rate(kafka_request_process_time_seconds_count{job=\"kafka-consumer\"}[$__rate_interval]))",
          "legendFormat": "Total TPS"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ops"
        },
        "overrides": []
      }
    },
    {
      "title": "Kafka Request Latency (Aggregated)",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 8,
        "y": 133
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.25, sum(rate(kafka_request_process_time_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p25"
        },
        {
          "expr": "histogram_quantile(0.50, sum(rate(kafka_request_process_time_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p50"
        },
        {
          "expr": "histogram_quantile(0.75, sum(rate(kafka_request_process_time_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p75"
        },
        {
          "expr": "histogram_quantile(0.90, sum(rate(kafka_request_process_time_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p90"
        },
        {
          "expr": "histogram_quantile(0.95, sum(rate(kafka_request_process_time_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p95"
        },
        {
          "expr": "histogram_quantile(0.99, sum(rate(kafka_request_process_time_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "p99"
        },
        {
          "expr": "histogram_quantile(0, sum(rate(kafka_request_process_time_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le))",
          "legendFormat": "min"
        },
        {
          "expr": "kafka_request_process_time_seconds_max{job=\"kafka-consumer\"}",
          "legendFormat": "max"
        },
        {
          "expr": "sum(rate(kafka_request_process_time_seconds_sum{job=\"kafka-consumer\"}[$__rate_interval])) / sum(rate(kafka_request_process_time_seconds_count{job=\"kafka-consumer\"}[$__rate_interval]))",
          "legendFormat": "avg"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      }
    },
    {
      "title": "Kafka Request Messages (Total)",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 133
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "sum(rate(kafka_request_messages_received_total{job=\"kafka-consumer\"}[$__rate_interval]))",
          "legendFormat": "received/s"
        },
        {
          "expr": "sum(rate(kafka_request_messages_processed_total{job=\"kafka-consumer\"}[$__rate_interval]))",
          "legendFormat": "processed/s"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ops"
        },
        "overrides": []
      }
    },
    {
      "title": "Kafka Request TPS",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 0,
        "y": 141
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(kafka_request_process_time_seconds_count{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "{{instance}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ops"
        },
        "overrides": []
      }
    },
    {
      "title": "Kafka Request Latency p95",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 8,
        "y": 141
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(kafka_request_process_time_seconds_bucket{job=\"kafka-consumer\"}[$__rate_interval])) by (le, pod))",
          "legendFormat": "{{instance}}"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "s"
        },
        "overrides": []
      }
    },
    {
      "title": "Kafka Request Messages",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 141
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "targets": [
        {
          "expr": "rate(kafka_request_messages_received_total{job=\"kafka-consumer\"}[$__rate_interval])",
          "legendFormat": "{{instance}} received"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "ops"
        },
        "overrides": []
      }
    }
  ],
  "refresh": "30s",
  "schemaVersion": 39,
  "templating": {
    "list": []
  },
  "time": {
    "from": "now-5m",
    "to": "now"
  },
  "title": "kafka-consumer",
  "uid": "kafka-consumer",
  "version": 1
}
